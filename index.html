<!DOCTYPE html>
<html lang='ja'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>HOAP AI ã‚­ãƒ£ãƒªã‚¢ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆ</title>
  <script src='https://cdn.tailwindcss.com'></script>
  <style>
    .gradient-bg { background: linear-gradient(135deg, #fdf2f8 0%, #faf5ff 50%, #eff6ff 100%); }
    .gradient-text {
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 50%, #3b82f6 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .message-enter { animation: slideIn .25s ease-out; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(8px) } to { opacity: 1; transform: translateY(0) } }
    .typing { display: inline-block; animation: pulse 1.5s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1 } 50% { opacity: .5 } }
  </style>
</head>
<body class='gradient-bg min-h-screen text-slate-800'>

  <!-- Header -->
  <div class='bg-white/90 backdrop-blur-sm border-b border-pink-100 sticky top-0 z-10 shadow-sm'>
    <div class='max-w-4xl mx-auto px-6 py-4 flex justify-between items-center'>
      <div>
        <h1 class='text-2xl font-bold gradient-text'>HOAP AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</h1>
        <p class='text-slate-600 text-sm'>ã‚­ãƒ£ãƒªã‚¢ç›¸è«‡ãƒ»ä¸€æ¬¡ãƒ’ã‚¢ãƒªãƒ³ã‚°</p>
      </div>
      <div class='text-right'>
        <div class='text-sm text-slate-500'>Step <span id='current-step'>1</span>/6</div>
        <div class='text-xs gradient-text font-medium'>
          <span id='step-label'>åŸºæœ¬æƒ…å ±</span>
          <span id='number-required' class='block text-red-400 text-xs mt-1'>â€»æ±‚è·è€…ç•ªå·å¿…é ˆ</span>
        </div>
      </div>
    </div>
    <div class='mt-2 bg-gradient-to-r from-pink-100 to-blue-100 rounded-full h-1'>
      <div id='progress-bar'
        class='bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 h-1 rounded-full transition-all duration-500'
        style='width: 16.67%'></div>
    </div>
  </div>

  <!-- Chat Area -->
  <div class='max-w-4xl mx-auto px-6 py-8 pb-32'>
    <div id='messages' class='space-y-6'>
      <div class='flex justify-start'>
        <div class='flex max-w-xs lg:max-w-2xl items-start gap-3'>
          <div class='flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-r from-gray-100 to-gray-200 shadow-md border-2 border-white flex items-center justify-center'>
            <span class='text-xl'>ğŸ¤–</span>
          </div>
          <div class='bg-white/90 backdrop-blur-sm text-slate-700 border border-pink-100/50 rounded-2xl px-4 py-3 shadow-sm'>
            <div class='text-sm whitespace-pre-wrap leading-relaxed'>
              ã“ã‚“ã«ã¡ã¯  
              æ‹…å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®é¢è«‡ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«ã™ã‚‹ãŸã‚ã«ã€æ ªå¼ä¼šç¤¾HOAPã®AIã‚­ãƒ£ãƒªã‚¢ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å…ˆã«å°‘ã—ã ã‘è©±ã‚’èã‹ã›ã¦ã­ã€‚<br><br>
              
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ ã¾ãš3ã¤ã ã‘æ•™ãˆã¦ï¼  
              â‘ æ±‚è·è€…ç•ªå· â‘¡ä»Šã®è·ç¨® â‘¢ä»Šã©ã“ã§åƒã„ã¦ã‚‹ï¼Ÿ
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Input -->
  <div class='fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-pink-100/50 shadow-xl'>
    <div class='max-w-4xl mx-auto px-6 py-4 flex items-end gap-3'>
      <div class='flex-1 relative'>
        <textarea id='message-input' placeholder='æ±‚è·è€…ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...'
          class='w-full bg-white border border-pink-200 rounded-xl px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-400 resize-none min-h-[52px] max-h-32 shadow-sm'></textarea>
      </div>
      <button id='send-button'
        class='bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 text-white rounded-xl p-3 shadow-lg'>
        <svg width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'>
          <line x1='22' y1='2' x2='11' y2='13'></line>
          <polygon points='22,2 15,22 11,13 2,9'></polygon>
        </svg>
      </button>
    </div>
  </div>

  <!-- Script -->
  <script>
    // çŠ¶æ…‹
    let currentStep = 0;
    let candidateNumber = '';
    let isNumberConfirmed = false;
    const sessionData = {
      candidateNumber: '',
      qualification: '',
      workplace: '',
      transferReason: '',
      mustConditions: [],
      wantConditions: [],
      canDo: '',
      willDo: ''
    };

    const steps = [
      { label: 'åŸºæœ¬æƒ…å ±' }, { label: 'è»¢è·ç†ç”±' },
      { label: 'çµ¶å¯¾æ¡ä»¶' }, { label: 'å¸Œæœ›æ¡ä»¶' },
      { label: 'çµŒé¨“' }, { label: 'æŒ‘æˆ¦' }
    ];

    // UI
    function updateProgressBar() {
      const progress = ((currentStep + 1) / 6) * 100;
      document.getElementById('progress-bar').style.width = `${progress}%`;
      document.getElementById('current-step').textContent = currentStep + 1;
      document.getElementById('step-label').textContent = steps[currentStep].label;
      document.getElementById('number-required').style.display = (currentStep === 0 && !isNumberConfirmed) ? 'block' : 'none';
    }

    function addMessage(type, content) {
      const messages = document.getElementById('messages');
      const div = document.createElement('div');
      div.className = `flex ${type === 'user' ? 'justify-end' : 'justify-start'} message-enter`;
      div.innerHTML = `
        <div class='flex max-w-xs lg:max-w-2xl ${type === 'user' ? 'flex-row-reverse' : 'flex-row'} items-start gap-3'>
          <div class='flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${
            type === 'user'
              ? 'bg-gradient-to-r from-pink-400 via-purple-400 to-blue-400 text-white'
              : 'bg-gradient-to-r from-gray-100 to-gray-200 border-2 border-white'
          }'>${type === 'user' ? '<svg width=\'18\' height=\'18\' viewBox=\'0 0 24 24\' stroke=\'currentColor\'><circle cx=\'12\' cy=\'7\' r=\'4\'></circle></svg>' : 'ğŸ¤–'}</div>
          <div class='rounded-2xl px-4 py-3 ${
            type === 'user'
              ? 'bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 text-white ml-auto'
              : 'bg-white/90 text-slate-700 border border-pink-100/50'
          }'><div class='text-sm whitespace-pre-wrap leading-relaxed'>${content}</div></div>
        </div>`;
      messages.appendChild(div);
      div.scrollIntoView({ behavior: 'smooth', block: 'end' });
    }

    function showTyping() {
      const messages = document.getElementById('messages');
      const div = document.createElement('div');
      div.id = 'typing-indicator';
      div.className = 'flex justify-start';
      div.innerHTML = `
        <div class='flex items-start gap-3'>
          <div class='flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-r from-gray-100 to-gray-200 border-2 border-white flex items-center justify-center'>ğŸ¤–</div>
          <div class='bg-white/90 border border-pink-100/50 rounded-2xl px-4 py-3'>
            <div class='flex items-center gap-2 text-slate-500'>
              <div class='typing'>â—</div>
              <div class='typing' style='animation-delay:.2s'>â—</div>
              <div class='typing' style='animation-delay:.4s'>â—</div>
              <span class='text-sm ml-2'>å›ç­”ã‚’æº–å‚™ä¸­...</span>
            </div>
          </div>
        </div>`;
      messages.appendChild(div);
      div.scrollIntoView({ behavior: 'smooth', block: 'end' });
    }
    function hideTyping() { const t = document.getElementById('typing-indicator'); if (t) t.remove(); }

    function updatePlaceholder() {
      const input = document.getElementById('message-input');
      input.placeholder = (currentStep === 0 && !isNumberConfirmed) ? 'æ±‚è·è€…ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...' : 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...';
    }

    // ä¼šè©±ãƒ¡ã‚¤ãƒ³ï¼ˆæŒ‡å®šã©ãŠã‚Šã®æ–‡é¢ï¼‰
    async function processMessage(message) {
      showTyping();
      await new Promise(r => setTimeout(r, 400));

      let response = '';
      let bump = false;

      if (currentStep === 0) {
        if (!isNumberConfirmed) {
          const m = message.match(/\d+/);
          if (m) {
            candidateNumber = m[0];
            sessionData.candidateNumber = candidateNumber;
            isNumberConfirmed = true;
            response = `æ±‚è·è€…ç•ªå·ï¼š${candidateNumber} ã‚’å—ã‘å–ã£ãŸã‚ˆã€‚
ç¶šã‘ã¦ã€ä»Šã®è·ç¨®ã¨å‹¤å‹™å…ˆã‚’æ•™ãˆã¦ã­ã€‚`;
          } else {
            response = `æœ€åˆã«æ±‚è·è€…ç•ªå·ã‚’æ•™ãˆã¦ã­ã€‚
ä¾‹ 12345`;
          }
        } else {
          sessionData.qualification = message;
          currentStep = 1; bump = true;
          response =
`ã‚ã‚ŠãŒã¨ã†ï¼

ã¾ãšã¯ã˜ã‚ã«ã€ä»Šå›ã®è»¢è·ç†ç”±ã‚’æ•™ãˆã¦ã»ã—ã„ãªã€‚ 
ãã£ã‹ã‘ã£ã¦ã©ã‚“ãªã“ã¨ã ã£ãŸï¼Ÿ
ã—ã‚“ã©ã„ã¨æ€ã£ãŸã“ã¨ã€ã“ã‚Œã¯ã‚‚ã†ç„¡ç†ã£ã¦æ€ã£ãŸã“ã¨ã€
é€†ã«ã“ã†ã„ã†ã“ã¨ã«æŒ‘æˆ¦ã—ãŸã„ï¼ã£ã¦æ€ã£ãŸã“ã¨ã€ä½•ã§ã‚‚OKã ã‚ˆâ—`;
        }
      }
      else if (currentStep === 1) {
        sessionData.transferReason = message;
        currentStep = 2; bump = true;
        response =
`äº†è§£ï¼

ã˜ã‚ƒã‚æ¬¡ã®è³ªå•ï¼
ä»Šå›ã®è»¢è·ã§ã“ã‚Œã ã‘ã¯çµ¶å¯¾è­²ã‚Œãªã„ï¼ã¨ã„ã†ã®ã‚’æ•™ãˆã¦ï¼
ä»•äº‹å†…å®¹ã§ã‚‚ã€åˆ¶åº¦ã§ã‚‚ã€æ¡ä»¶ã§ã‚‚OKâ—

ä¾‹ãˆã°ãƒ»ãƒ»ãƒ»
çµ¶å¯¾åœŸæ—¥ä¼‘ã¿ã˜ã‚ƒãªã„ã¨å›°ã‚‹ï¼
çµ¶å¯¾ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ã¯ã§ããªã„ï¼

å¾Œã‹ã‚‰ã€Œã‚ã‚‹ã¨ã„ã„ãªã€ã«ã¤ã„ã¦ã‚‚èãã‹ã‚‰ã€ä»Šã¯ã€Œçµ¶å¯¾ã€ã ã‘æ•™ãˆã¦ã­ã€‚`;
      }
      else if (currentStep === 2) {
        if (/ãªã—|ãªã„/i.test(message)) {
          currentStep = 3; bump = true;
          response =
`ã‚ã‚ŠãŒã¨ã†ï¼
ãã‚Œã˜ã‚ƒã‚æ¬¡ã«ã€Œã“ã†ã ã£ãŸã‚‰ã„ã„ãªã€ã¨ã„ã†ã®ã‚’èã„ã¦ã„ãã­ã€‚
ã“ã‚Œã‚‚ä»•äº‹å†…å®¹ã§ã‚‚ã€åˆ¶åº¦ã§ã‚‚ã€æ¡ä»¶é¢ã§ã‚‚OKâ—

ä¾‹ãˆã°ãƒ»ãƒ»ãƒ»
ãƒã‚¤ã‚«ãƒ¼é€šå‹¤ãŒã§ãã‚‹ã¨å¬‰ã—ã„ãª
ã§ãã‚Œã°å¤œå‹¤ãŒãªã„ã¨ã„ã„ãª

ã£ã¦æ„Ÿã˜ï¼`;
        } else {
          sessionData.mustConditions.push(message);
          response =
`å—ã‘å–ã£ãŸï¼š${message}
ä»–ã«ã‚‚çµ¶å¯¾æ¡ä»¶ãŒã‚ã‚Œã°ç¶šã‘ã¦ã©ã†ãã€‚ãªã‘ã‚Œã° ãªã— ã¨å…¥åŠ›ã€‚`;
        }
      }
      else if (currentStep === 3) {
        if (!/ãªã—|ãªã„/i.test(message)) sessionData.wantConditions.push(message);
        currentStep = 4; bump = true;
        response =
`è³ªå•ã¯æ®‹ã‚Š2ã¤ï¼
ã‚ã¨å°‘ã—ã„ãã‚ˆã€‚

æ¬¡ã«æ•™ãˆã¦æ¬²ã—ã„ã®ã¯ ã“ã‚Œã¾ã§ã‚„ã£ã¦ããŸã“ã¨ã€‚
æ¬¡å›ã®é¢è«‡ã§æ·±æ˜ã‚Šã™ã‚‹ã‹ã‚‰ã€ã–ã£ãã‚Šã§OKã€‚
ã“ã‚Œã‹ã‚‰ã‚‚æ´»ã‹ã—ãŸã„ã“ã¨ã‚’æ•™ãˆã¦ã­ã€‚`;
      }
      else if (currentStep === 4) {
        sessionData.canDo = message;
        currentStep = 5; bump = true;
        response =
`ã“ã‚ŒãŒæœ€å¾Œã®è³ªå•ğŸ‘
ä»Šå›ã®è»¢è·ã§å¶ãˆãŸã„æŒ‘æˆ¦ã‚„ã€å¤¢ã¯ã‚ã‚‹ï¼Ÿ`;
      }
      else if (currentStep === 5) {
        sessionData.willDo = message;
        currentStep = 6; bump = true;
        response =
`ä»Šæ—¥ã¯ãŸãã•ã‚“è©±ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼
ã“ã“ã¾ã§ã®å†…å®¹ã‚’æ‹…å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å¼•ãç¶™ãã­ã€‚
æ¬¡å›ã®é¢è«‡ã§ä¸€ç·’ã«è©°ã‚ã¦ã„ã“ã†ï¼

ğŸ“‹ åé›†ãƒ‡ãƒ¼ã‚¿
æ±‚è·è€…ç•ªå·: ${sessionData.candidateNumber}
è»¢è·ç†ç”±: ${sessionData.transferReason}
çµ¶å¯¾æ¡ä»¶: ${sessionData.mustConditions.length ? sessionData.mustConditions.join(', ') : 'æœªè¨­å®š'}
å¸Œæœ›æ¡ä»¶: ${sessionData.wantConditions.length ? sessionData.wantConditions.join(', ') : 'æœªè¨­å®š'}
æ´»ã‹ã—ãŸã„çµŒé¨“: ${sessionData.canDo}
æŒ‘æˆ¦ã—ãŸã„ã“ã¨: ${sessionData.willDo}`;
      }

      hideTyping();
      addMessage('ai', response);
      if (bump) { updateProgressBar(); updatePlaceholder(); }
    }

    // é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ
    document.getElementById('send-button').addEventListener('click', async () => {
      const input = document.getElementById('message-input');
      const text = input.value.trim();
      if (!text) return;
      addMessage('user', text);
      input.value = '';
      await processMessage(text);
    });

    document.getElementById('message-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        document.getElementById('send-button').click();
      }
    });

    // åˆæœŸåŒ–
    updateProgressBar();
    updatePlaceholder();
  </script>
</body>
</html>
